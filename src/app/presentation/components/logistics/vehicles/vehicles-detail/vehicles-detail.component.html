<div class="w-full min-h-screen flex flex-col items-center pt-10 pb-10 bg-gray-50">

    <div class="w-11/12 max-w-4xl bg-white p-8 rounded-3xl border border-gray-200 shadow-sm">

        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">
                    {{ isNewVehicle ? 'Nueva Camioneta' : 'Detalle de Camioneta' }}
                </h1>
                <p *ngIf="!isNewVehicle && vehicleForm.get('plateNumber')?.value" class="text-gray-500 mt-1">
                    Placa: {{ vehicleForm.get('plateNumber')?.value }}
                </p>
            </div>

            <button (click)="router.navigate(['/logistics/vehicles'])" class="px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 
                       border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                ← Volver
            </button>
        </div>

        <div *ngIf="loading" class="flex justify-center items-center py-12">
            <p class="text-gray-600">Cargando...</p>
        </div>

        <div *ngIf="error" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
            <p class="text-red-600">{{ error }}</p>
        </div>

        <form *ngIf="!loading" [formGroup]="vehicleForm" (ngSubmit)="onSubmit()" class="space-y-6">

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Placa <span class="text-red-500">*</span>
                </label>
                <input type="text" formControlName="plateNumber" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed" placeholder="Ej: ABC-123" />
                <p *ngIf="getFieldError('plateNumber')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('plateNumber') }}
                </p>
                <p *ngIf="!isNewVehicle" class="mt-1 text-xs text-gray-500">
                    La placa no puede ser modificada
                </p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Marca <span class="text-red-500">*</span>
                </label>
                <input type="text" formControlName="brand" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed"
                    placeholder="Ej: Toyota, Chevrolet, Ford" />
                <p *ngIf="getFieldError('brand')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('brand') }}
                </p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Modelo <span class="text-red-500">*</span>
                </label>
                <input type="text" formControlName="model" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed"
                    placeholder="Ej: Hilux, Silverado, F-150" />
                <p *ngIf="getFieldError('model')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('model') }}
                </p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Año <span class="text-red-500">*</span>
                </label>
                <input type="number" formControlName="year" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed" placeholder="Ej: 2024" min="1900"
                    max="2100" />
                <p *ngIf="getFieldError('year')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('year') }}
                </p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Estado <span class="text-red-500">*</span>
                </label>
                <select formControlName="status" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed">
                    <option value="">Seleccione un estado</option>
                    <option *ngFor="let status of availableStatuses" [value]="status">
                        {{ status === 'Available' ? 'Disponible' :
                        status === 'InUse' ? 'En Uso' :
                        status === 'Maintenance' ? 'En Mantenimiento' :
                        'Fuera de Servicio' }}
                    </option>
                </select>
                <p *ngIf="getFieldError('status')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('status') }}
                </p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Tipo de Propiedad <span class="text-red-500">*</span>
                </label>
                <select formControlName="ownership" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed">
                    <option *ngFor="let ownership of availableOwnerships" [value]="ownership.value">
                        {{ ownership.label }}
                    </option>
                </select>
                <p *ngIf="getFieldError('ownership')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('ownership') }}
                </p>
            </div>

            <div *ngIf="isRented">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Proveedor <span class="text-red-500">*</span>
                </label>
                <select formControlName="supplierId" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
               disabled:bg-gray-100 disabled:cursor-not-allowed">
                    <option [value]="null">Seleccione un proveedor</option>
                    <option *ngFor="let supplier of suppliers" [value]="supplier.id">
                        {{ supplier.name }}
                    </option>
                </select>
                <p *ngIf="getFieldError('supplierId')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('supplierId') }}
                </p>
            </div>

            <div *ngIf="!isRented">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Costo por Mes
                </label>
                <input type="number" formControlName="costPerMonth" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed" placeholder="Ej: 4500000" min="0"
                    step="0.01" />
                <p class="mt-1 text-xs text-gray-500">
                    Ingresa el costo mensual y se calculará automáticamente el costo diario
                </p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Costo por Día <span class="text-red-500">*</span>
                </label>
                <input type="number" formControlName="costPerDay" [readonly]="!isRented" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent
                           disabled:bg-gray-100 disabled:cursor-not-allowed" [class.bg-gray-50]="!isRented"
                    placeholder="Ej: 150000" min="0" step="0.01" />
                <p *ngIf="getFieldError('costPerDay')" class="mt-1 text-sm text-red-600">
                    {{ getFieldError('costPerDay') }}
                </p>
                <p *ngIf="!isRented" class="mt-1 text-xs text-gray-500">
                    Calculado automáticamente desde el costo mensual (÷ 30 días)
                </p>
            </div>

            <div class="flex justify-between items-center pt-6 border-t border-gray-200">

                <div class="flex gap-3">
                    <button *ngIf="!isNewVehicle && !isEditMode" type="button" (click)="toggleEditMode()" class="px-6 py-2 text-sm font-semibold bg-blue-500 text-white rounded-lg
                               hover:bg-blue-600 transition-colors">
                        Editar
                    </button>

                    <button *ngIf="isEditMode" type="submit" [disabled]="saving || vehicleForm.invalid" class="px-6 py-2 text-sm font-semibold bg-green-500 text-white rounded-lg
                               hover:bg-green-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed">
                        {{ saving ? 'Guardando...' : 'Guardar' }}
                    </button>

                    <button *ngIf="isEditMode" type="button" (click)="onCancel()" [disabled]="saving" class="px-6 py-2 text-sm font-semibold bg-gray-200 text-gray-700 rounded-lg
                               hover:bg-gray-300 transition-colors disabled:bg-gray-100 disabled:cursor-not-allowed">
                        Cancelar
                    </button>
                </div>

                <button *ngIf="!isNewVehicle && isEditMode" type="button" (click)="onDelete()" [disabled]="saving"
                    class="px-6 py-2 text-sm font-semibold bg-red-500 text-white rounded-lg
                           hover:bg-red-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed">
                    Eliminar
                </button>

            </div>

        </form>

    </div>

</div>